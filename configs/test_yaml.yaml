datasets:
  cora:
    name: &dataset_name 'cora'
    root: &root_dir !join ['./resource/dataset/', *dataset_name]

models:
  teacher_model:
    key: 'gcn'
    kwargs:
      in_channels: 1433
      out_channels: 7
    src_ckpt:
    dst_ckpt: !join ['./resource/ckpt/', *dataset_name, 'teacher_model.pt']

  student_model:
    key: 'gcn'
    kwargs:
      in_channels: 1433
      out_channels: 7
    src_ckpt:
    dst_ckpt: !join ['./resource/ckpt/', *dataset_name, 'student_model.pt']

train:
  num_epochs: 182
  teacher:
    forward_proc: 'forward_batch_only'
    requires_grad: False
  student:
    forward_proc: 'forward_batch_only'
    requires_grad: True
  optimizer:
    key: 'SGD'
    kwargs:
      lr: 0.1
      momentum: 0.9
      weight_decay: 0.0001
  criterion:
    key: 'WeightedSumLoss'
    kwargs:
      sub_terms:
        kd:
          criterion:
            key: 'KDLoss'
            kwargs:
              student_module_path: '.'
              student_module_io: 'output'
              teacher_module_path: '.'
              teacher_module_io: 'output'
              temperature: 4.0
              alpha: 0.9
              reduction: 'batchmean'
          weight: 1.0
test: